<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.4">
<meta name="description" content="A few words of description.">
<meta name="keywords" content="asciidoctor, basics, getting started">
<meta name="author" content="Gary Dalton">
<title>Using Asciidoctor</title>
<link rel="stylesheet" href="stylesheets/github.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css">
<link rel="stylesheet" href="stylesheets/coderay-asciidoctor.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Using Asciidoctor</h1>
<div class="details">
<span id="author" class="author">Gary Dalton</span><br>
<span id="revnumber">version 1.0,</span>
<span id="revdate">20 September 2016</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_references">References</a></li>
<li><a href="#_contents">Contents</a></li>
<li><a href="#_procedures">Procedures</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>A few words of description.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/gary-dalton/RaspberryPi-projects/tree/gh-pages">View on GitHub <span class="image"><img src="images/GitHub-Mark-32px.png" alt="GitHub Mark 32px"></span></a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_references">References</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="http://powerman.name/doc/asciidoc">AsciiDoc cheatsheet</a></p>
</li>
<li>
<p><a href="http://asciidoctor.org/docs/asciidoc-syntax-quick-reference/">AsciiDoc Syntax Quick Reference</a></p>
</li>
<li>
<p><a href="http://asciidoctor.org/docs/user-manual">Asciidoctor User Manual</a></p>
</li>
<li>
<p><a href="http://themes.asciidoctor.org/preview/">Themes preview</a>
*</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_contents">Contents</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="title">app.py</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="comment">## python</span>

<span class="keyword">import</span> <span class="include">smbus</span>
<span class="keyword">import</span> <span class="include">os</span>

<span class="comment"># Release RTC 3231</span>
os.system(<span class="string"><span class="delimiter">'</span><span class="content">sudo rmmod rtc_ds1307</span><span class="delimiter">'</span></span>)

<span class="comment"># Setup RTC 3231 for temperature reading</span>
bus = smbus.SMBus(<span class="integer">1</span>)
address = <span class="hex">0x68</span>
CONV = <span class="integer">32</span>

<span class="comment"># Force a conversion and wait until it completes</span>
<span class="keyword">def</span> <span class="function">convTemp</span>(address):
    byte_control = bus.read_byte_data(address,<span class="hex">0x0E</span>)
    <span class="keyword">if</span> byte_control&amp;CONV == <span class="integer">0</span>:
        bus.write_byte_data(address, <span class="hex">0x0E</span>, byte_control|CONV)
    byte_control = bus.read_byte_data(address,<span class="hex">0x0E</span>)
        <span class="keyword">while</span> byte_control&amp;CONV != <span class="integer">0</span>:
                time.sleep(<span class="integer">1</span>)
                byte_control = bus.read_byte_data(address,<span class="hex">0x0E</span>)
    <span class="keyword">return</span> <span class="predefined-constant">True</span>

<span class="comment"># Get temperature in degrees C</span>
<span class="keyword">def</span> <span class="function">getTemp</span>(address):
    convTemp(address)
    byte_tmsb = bus.read_byte_data(address,<span class="hex">0x11</span>)
    byte_tlsb = bus.read_byte_data(address,<span class="hex">0x12</span>)
    tinteger = (byte_tmsb &amp; <span class="hex">0x7f</span>) + ((byte_tmsb &amp; <span class="hex">0x80</span>) &gt;&gt; <span class="integer">7</span>) * -<span class="integer">2</span>**<span class="integer">8</span>
    tdecimal = (byte_tmsb &gt;&gt; <span class="integer">7</span>) * <span class="integer">2</span>**(-<span class="integer">1</span>) + ((byte_tmsb &amp; <span class="hex">0x40</span>) &gt;&gt; <span class="integer">6</span>) * <span class="integer">2</span>**(-<span class="integer">2</span>)
    <span class="keyword">return</span> tinteger + tdecimal

Celsius = getTemp(address)
Fahrenheit = <span class="float">9.0</span>/<span class="float">5.0</span> * Celsius + <span class="integer">32</span>
<span class="keyword">print</span> Fahrenheit, <span class="string"><span class="delimiter">&quot;</span><span class="content">*F /</span><span class="delimiter">&quot;</span></span>, Celsius, <span class="string"><span class="delimiter">&quot;</span><span class="content">*C</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_procedures">Procedures</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Pay attention to this
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Pay attention to this
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Pay attention to this
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Pay attention to this
</td>
</tr>
</table>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Pay attention to this
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Pay attention to this
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a href="https://tedbergeron.github.io/2015/03/29/Atom-Editor-for-Ascii-Doc.html" class="bare">https://tedbergeron.github.io/2015/03/29/Atom-Editor-for-Ascii-Doc.html</a></p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 1.0<br>
Last updated 2016-09-26 08:17:32 Central Daylight Time
</div>
</div>
</body>
</html>